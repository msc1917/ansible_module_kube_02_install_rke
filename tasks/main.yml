---
- name: Setup Kubernetes Hosts
  include_tasks: initial/main.yml
  when:
    - k8s_node is defined
    - k8s_node in [ "install_master", "become_master", "node" ]

- name: Deinstall other kubernetes-engines
  include_tasks: cleanup/main.yml
  when:
    - k8s_node is defined
    - k8s_node in [ "install_master", "become_master", "node" ]

- name: Install minikube-engine
  include_tasks: engine_minikube/main.yml
  when:
    - k8s_node is defined
    - k8s_node in [ "install_master", "become_master", "node" ]
    - kubernetes_engine == "minikube"

- name: Install vanilla kubernetes
  include_tasks: engine_kubeadm/main.yml
  when:
    - k8s_node is defined
    - k8s_node in [ "install_master", "become_master", "node" ]
    - kubernetes_engine == "kubeadm"

- name: Install rke-engine
  include_tasks: engine_rke/main.yml
  when:
    - k8s_node is defined
    - k8s_node in [ "install_master", "become_master", "node" ]
    - kubernetes_engine == "rke"

- name: Install k3s-engine
  include_tasks: engine_k3s/main.yml
  when:
    - k8s_node is defined
    - k8s_node in [ "install_master", "become_master", "node" ]
    - kubernetes_engine == "k3s"